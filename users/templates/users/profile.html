{% extends 'base.html' %}
{% load state_face %}

{% block main %}

<div class="row">
  {% if profile.preferred_candidate and profile.state %}
  <div class="col-md-8 col-md-offset-2 alert" role="alert">
    <p>Hello, {{ profile.fb_name }}. You're a {{ profile.preferred_candidate }} voter in {{ profile.state }}.</p>
  </div>
  {% else %}
  <div class="col-md-8 col-md-offset-2 alert alert-danger" role="alert">
    <p>We're missing some information from you and can't match you with friends
    until you <a href="{% url "users:update_profile" %}">update your profile</a>.</p>
  </div>
  {% endif %}
</div>

<!--
{% for fm_ctx in profile_context.good_potential_matches %}
<div class="col-sm-4 swap-option js-swap-option {% if fm_ctx.has_been_proposed_to %}proposed{% endif %}">
    <div class="clearfix">
      <div class="pull-left">
        <img src="https://graph.facebook.com/v2.7/{{ profile.fb_id }}/picture?type=normal" />
      </div>
      <div class="pull-left">
        <h2>{{ fm_ctx.name }}{% if not fm_ctx.friend_match.is_direct %} (via {{ fm_ctx.friend_match.through.user.get_full_name }}){% endif %}</h2>
      </div>
    </div>
    <div class="proposed-content">
      You have proposed to this friend.
    </div>
    <div class="not-proposed-content">
      <p>{{ fm_ctx.proposal_string }}</p>
      <button type="button" class="btn btn-primary js-propose-swap" data-profile-id="{{fm_ctx.friend_match.profile.id}}" data-name="{{ fm_ctx.name }}">Swap with {{ fm_ctx.name }}</button>
    </div>
  </div>
</div>
{% endfor %}
-->

<div class="row">
{% for fm_ctx in profile_context.good_potential_matches %}
<div class="col-sm-9 col-md-6 swap-option js-swap-option {% if fm_ctx.has_been_proposed_to %}proposed{% endif %}">
  <div class="well match clearfix">
    <div class="match-image col-sm-6 text-center">
      <img class="match img-responsive pull-center"
           src="https://graph.facebook.com/v2.7/{{ fm_ctx.friend_match.profile.fb_id }}/picture?type=square&width=200&height=200"
           alt="{{ fm_ctx.name }}'s image"/>
      <h2><a href="https://facebook.com/{{ fm_ctx.friend_match.profile.fb_id }}">{{ fm_ctx.name }}</a></h2>
      <h3>{% if not fm_ctx.friend_match.is_direct %}via <a href="https://facebook.com/{{ fm_ctx.friend_match.through.fb_id }}">{{ fm_ctx.friend_match.through.user.get_full_name }}</a>{% else %}&nbsp;{% endif %}</h3>
    </div>
    <div class="col-md-6 match-info">
      <p style="font-size:4em" class="text-center">
        <span class="stateface">{{ profile.state|stateface }}</span><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24"><path d="M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"/></svg><span class="stateface">{{ fm_ctx.friend_match.profile.state|stateface }}</span>
      </p>
      <div class="proposed-content">
        <p>You have proposed to {{ fm_ctx.friend_match.profile.fb_name }}.</p>
        <a role="button" class="btn btn-info btn-lg">Message</a>
      </div>
      <div class="not-proposed-content">
        <p>{{ fm_ctx.proposal_string }}</p>
        <button type="button" class="btn btn-success btn-lg js-propose-swap" data-profile-id="{{fm_ctx.friend_match.profile.id}}" data-name="{{ fm_ctx.name }}">Swap</button>
        <a role="button" class="btn btn-info btn-lg">Message</a>
      </div>
      <br />
    </div>
  </div>
</div>
{% endfor %}
</div>
{% endblock %}
